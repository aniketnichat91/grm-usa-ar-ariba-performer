/*!
 * Copyright UiPath 2021
 * This file contains code from WebPack - https://github.com/webpack/webpack - MIT license
 */
(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=='undefined'&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:'Module'})}Object.defineProperty(exports,'__esModule',{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if((mode&4)&&typeof value==='object'&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,'default',{enumerable:true,value:value});if(mode&2&&typeof value!='string')for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};__webpack_require__.d(getter,'a',getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s="./Source/Background/BackgroundMain.ts")})({"./Source/Background/BackgroundGlobals.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BackgroundGlobals=void 0;var BackgroundGlobals;(function(BackgroundGlobals){var g_uiPathGlobalVariablesKey="g_uiPath_GlobalVariables";function RegisterLoaderWin32(globalScope,loader){GetGlobalVariables(globalScope).loaderWin32=loader}BackgroundGlobals.RegisterLoaderWin32=RegisterLoaderWin32;function GetLoaderWin32(globalScope){return GetGlobalVariables(globalScope).loaderWin32}BackgroundGlobals.GetLoaderWin32=GetLoaderWin32;function RegisterLoaderPortable(globalScope,loader){GetGlobalVariables(globalScope).loaderPortable=loader}BackgroundGlobals.RegisterLoaderPortable=RegisterLoaderPortable;function GetLoaderPortable(globalScope){return GetGlobalVariables(globalScope).loaderPortable}BackgroundGlobals.GetLoaderPortable=GetLoaderPortable;function RegisterExtensionErrorService(globalScope,service){GetGlobalVariables(globalScope).extensionErrorService=service}BackgroundGlobals.RegisterExtensionErrorService=RegisterExtensionErrorService;function GetExtensionErrorService(globalScope){return GetGlobalVariables(globalScope).extensionErrorService}BackgroundGlobals.GetExtensionErrorService=GetExtensionErrorService;function GetGlobalVariables(globalScope){var globals=globalScope[g_uiPathGlobalVariablesKey];if(!globals){globals={loaderWin32:null,loaderPortable:null,extensionErrorService:null};globalScope[g_uiPathGlobalVariablesKey]=globals}return globals}})(BackgroundGlobals=exports.BackgroundGlobals||(exports.BackgroundGlobals={}))}),"./Source/Background/BackgroundMain.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var BrowserTools_1=__webpack_require__("./Source/Utility/BrowserTools.ts");var DriverPackageManager_1=__webpack_require__("./Source/Background/DriverPackageManager.ts");var LoaderWin32_1=__webpack_require__("./Source/Background/LoaderWin32.ts");var LoaderPortable_1=__webpack_require__("./Source/Background/LoaderPortable.ts");var Logger_1=__webpack_require__("./Source/Utility/Logger.ts");var BackgroundGlobals_1=__webpack_require__("./Source/Background/BackgroundGlobals.ts");var ExtensionErrorService_1=__webpack_require__("./Source/ErrorPopup/ExtensionErrorService.ts");Logger_1.Logger.Log("[BackgroundMain]");var globalScope=window;globalScope["chrome"]=globalScope["chrome"]||globalScope["browser"];var extensionErrorService=new ExtensionErrorService_1.ExtensionErrorService;var packageManager=new DriverPackageManager_1.DriverPackageManager;var loaderWin32=new LoaderWin32_1.LoaderWin32(packageManager,extensionErrorService);var loaderPortable=new LoaderPortable_1.LoaderPortable(packageManager);BackgroundGlobals_1.BackgroundGlobals.RegisterExtensionErrorService(globalScope,extensionErrorService);BackgroundGlobals_1.BackgroundGlobals.RegisterLoaderWin32(globalScope,loaderWin32);BackgroundGlobals_1.BackgroundGlobals.RegisterLoaderPortable(globalScope,loaderPortable);if(chrome&&chrome.management&&chrome.management.get&&chrome.management.setEnabled){try{var oldExtensionId="dpncpimghfponcpjkgihfikppbbhchil";chrome.management.get(oldExtensionId,function(result){if(chrome.runtime.lastError){}else if(result&&result.enabled){Logger_1.Logger.Log("Found deprecated and enabled UiPath extension");chrome.management.setEnabled(oldExtensionId,false,function(){if(chrome.runtime.lastError){Logger_1.Logger.Error("Disable deprecated UiPath extension failed, msg: "+chrome.runtime.lastError.message)}else{Logger_1.Logger.Log("Disabled deprecated UiPath extension")}})}})}catch(e){Logger_1.Logger.Error("UiPath Exception: "+e)}}chrome.runtime.onInstalled.addListener(function(details){try{if(details.reason=="install"){Logger_1.Logger.Log("UiPath extension first installed")}else if(details.reason=="update"){var thisVersion=chrome.runtime.getManifest().version;Logger_1.Logger.Log("UiPath extension updated from "+details.previousVersion+" to "+thisVersion+"!")}chrome.tabs.query({},function(tabsList){for(var _i=0,tabsList_1=tabsList;_i<tabsList_1.length;_i++){var tab=tabsList_1[_i];if(!BrowserTools_1.BrowserTools.IsBrowserSettingsUrl(tab.url)){chrome.tabs.reload(tab.id,{})}}})}catch(e){Logger_1.Logger.Error("UiPath Exception: "+e)}})}),"./Source/Background/CustomLoaderService.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CustomLoaderService=void 0;var BackgroundEvalService_1=__webpack_require__("./Source/Eval/BackgroundEvalService.ts");var Logger_1=__webpack_require__("./Source/Utility/Logger.ts");var CustomLoaderService=(function(){function CustomLoaderService(){}CustomLoaderService.AddCustomLoader=function(request,nativeHost,packageManager,onCompletedCb){Logger_1.Logger.Log("[AddCustomLoader] request.codeVersion: "+request.codeVersion);nativeHost.SetClient(null);CustomLoaderService.g_customLoaders[request.codeVersion]=BackgroundEvalService_1.BackgroundEvalService.EvalLoader(request.BackgroundLoader,nativeHost,packageManager);var contentLoaderCode={Version:request.codeVersion,ContentCode:request.ContentLoader};packageManager.AddCustomContentLoader(contentLoaderCode,onCompletedCb)};CustomLoaderService.g_customLoaders={};return CustomLoaderService}());exports.CustomLoaderService=CustomLoaderService}),"./Source/Background/DriverPackage.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DriverPackage=void 0;var BackgroundEvalService_1=__webpack_require__("./Source/Eval/BackgroundEvalService.ts");var Logger_1=__webpack_require__("./Source/Utility/Logger.ts");var DriverPackage=(function(){function DriverPackage(codeData,nativeHostToBackground){this.m_impl=null;this.m_functionCallMap=null;Logger_1.Logger.Log("[DriverPackage] version: "+codeData.version);this.m_version=codeData.version;this.m_contentCode=codeData.content;this.m_impl=BackgroundEvalService_1.BackgroundEvalService.EvalDriver(codeData,nativeHostToBackground);this.m_functionCallMap=this.m_impl.FunctionCallMap}DriverPackage.prototype.Activate=function(){Logger_1.Logger.Log("[Activate] version: "+this.m_version);if(this.m_impl.InitializeBackground){this.m_impl.InitializeBackground()}};DriverPackage.prototype.PostContentInitialize=function(){Logger_1.Logger.Log("[PostContentInitialize]");if(this.m_impl.PostContentInitialize){this.m_impl.PostContentInitialize()}};DriverPackage.prototype.Deactivate=function(){Logger_1.Logger.Log("[Deactivate] version: "+this.m_version);if(this.m_impl.FinalizeBackground){this.m_impl.FinalizeBackground()}};DriverPackage.prototype.ProcessRequest=function(message,onCompletedCb){var handler=null;if(this.m_functionCallMap){handler=this.m_functionCallMap[message.functionCall]}if(handler){handler(message,onCompletedCb)}else{Logger_1.Logger.Error("[ProcessRequest]: requested function is not available message.functionCall: "+message.functionCall)}};DriverPackage.prototype.GetVersion=function(){return this.m_version};DriverPackage.prototype.GetContentCode=function(){return this.m_contentCode};return DriverPackage}());exports.DriverPackage=DriverPackage}),"./Source/Background/DriverPackageManager.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DriverPackageManager=void 0;var DriverPackage_1=__webpack_require__("./Source/Background/DriverPackage.ts");var Logger_1=__webpack_require__("./Source/Utility/Logger.ts");var BrowserTools_1=__webpack_require__("./Source/Utility/BrowserTools.ts");var ContentLoader_1=__webpack_require__("./Source/Content/ContentLoader.ts");var DriverPackageManager=(function(){function DriverPackageManager(){var _this=this;this.m_drivers={};this.m_customContentLoaders=[];this.m_activeDriver=null;chrome.runtime.onMessage.addListener(function(msg,sender,responseCb){if(msg===ContentLoader_1.ContentLoaderRequestId.GetContentScripts){_this.OnContentScriptLoadRequest(sender,responseCb)}})}DriverPackageManager.prototype.LoadDriverPackage=function(codeData,nativeHostToBackground,onCompletedCb){var codeVersion=codeData.version;Logger_1.Logger.Log("[LoadDriverPackage] codeVersion: "+codeVersion);this.m_drivers[codeVersion]=new DriverPackage_1.DriverPackage(codeData,nativeHostToBackground);this.ActivateDriverVersion(codeVersion,function(driver){onCompletedCb()})};DriverPackageManager.prototype.ProcessRequest=function(codeVersion,message,onCompletedCb){this.ActivateDriverVersion(codeVersion,function(driver){driver.ProcessRequest(message,onCompletedCb)})};DriverPackageManager.prototype.IsCodeVersionAvailable=function(codeVersion){var driver=this.m_drivers[codeVersion];return(driver!=null)};DriverPackageManager.prototype.AddCustomContentLoader=function(contentLoaderCode,onCompletedCb){this.m_customContentLoaders.push(contentLoaderCode);var getInputParamsCb=function(tab){return{type:ContentLoader_1.ContentLoaderMessageId.AddCustomLoader,ContentLoaderCode:contentLoaderCode}};BrowserTools_1.BrowserTools.SendMessageToAllTabs(getInputParamsCb,function(){Logger_1.Logger.Log("[AddCustomContentLoader] Initialized all tabs; version: "+contentLoaderCode.Version);onCompletedCb()})};DriverPackageManager.prototype.ActivateDriverVersion=function(codeVersion,onActivatedCb){var _this=this;var requestedDriver=this.m_drivers[codeVersion];if(!requestedDriver){Logger_1.Logger.Error("[ActivateDriverVersion] Unavailable codeVersion: "+codeVersion);return}if(this.m_activeDriver===requestedDriver){onActivatedCb(this.m_activeDriver);return}var currentDriver=this.m_activeDriver;this.m_activeDriver=null;this.DeactivateDriver(currentDriver,function(){_this.m_activeDriver=requestedDriver;_this.ActivateDriver(requestedDriver,function(){Logger_1.Logger.Log("[ActivateDriverVersion] Activated codeVersion: "+codeVersion);onActivatedCb(requestedDriver)})})};DriverPackageManager.prototype.ActivateDriver=function(driver,onCompletedCb){var _this=this;driver.Activate();var getInputParamsCb=function(tab){return{type:ContentLoader_1.ContentLoaderMessageId.LoadDriver,DriverCode:_this.GetDriverContentCode(driver),Tab:tab}};BrowserTools_1.BrowserTools.SendMessageToAllTabs(getInputParamsCb,function(){Logger_1.Logger.Log("[ActivateDriver] initialized all tabs; version: "+driver.GetVersion());driver.PostContentInitialize();onCompletedCb()})};DriverPackageManager.prototype.DeactivateDriver=function(driver,onCompletedCb){if(!driver){onCompletedCb();return}var getInputParamsCb=function(tab){return{type:ContentLoader_1.ContentLoaderMessageId.UnloadDriver,Tab:tab}};BrowserTools_1.BrowserTools.SendMessageToAllTabs(getInputParamsCb,function(){Logger_1.Logger.Log("[DeactivateDriver] Unloaded driver from all tabs; version: "+driver.GetVersion());driver.Deactivate();onCompletedCb()})};DriverPackageManager.prototype.OnContentScriptLoadRequest=function(sender,responseCb){var _a;var response={DriverCode:null,CustomLoaders:this.m_customContentLoaders,Tab:sender.tab};if(this.m_activeDriver){Logger_1.Logger.Log("[OnContentScriptLoadRequest] Loading scripts"+" with version: "+this.m_activeDriver.GetVersion()+" in tab.id: "+((_a=sender.tab)===null||_a===void 0?void 0:_a.id)+" sender.frameId: "+sender.frameId);response.DriverCode=this.GetDriverContentCode(this.m_activeDriver)}else{Logger_1.Logger.Log("[OnContentScriptLoadRequest] No Driver package loaded")}responseCb(response)};DriverPackageManager.prototype.GetDriverContentCode=function(driver){return{Version:driver.GetVersion(),ContentCode:driver.GetContentCode()}};return DriverPackageManager}());exports.DriverPackageManager=DriverPackageManager}),"./Source/Background/LoaderPortable.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LoaderPortable=void 0;var NativeHostConnector_1=__webpack_require__("./Source/Background/NativeHostConnector.ts");var Logger_1=__webpack_require__("./Source/Utility/Logger.ts");var CustomLoaderService_1=__webpack_require__("./Source/Background/CustomLoaderService.ts");var ExtensionResponseCode;(function(ExtensionResponseCode){ExtensionResponseCode[ExtensionResponseCode["Error_Timeout"]=0]="Error_Timeout";ExtensionResponseCode[ExtensionResponseCode["Error_NeedsScripts"]=1]="Error_NeedsScripts";ExtensionResponseCode[ExtensionResponseCode["Success"]=2]="Success"})(ExtensionResponseCode||(ExtensionResponseCode={}));;var NativeHostFunctionCall;(function(NativeHostFunctionCall){NativeHostFunctionCall["LoadScripts"]="LoadScripts";NativeHostFunctionCall["AddCustomLoader"]="AddCustomLoader"})(NativeHostFunctionCall||(NativeHostFunctionCall={}));;var LoaderPortable=(function(){function LoaderPortable(packageManager){this.m_packageManager=packageManager;this.m_nativeHost=new NativeHostConnector_1.NativeHostConnector("com.uipath.portable_host",this)}LoaderPortable.prototype.OnNativeHostConnected=function(){Logger_1.Logger.Log("[OnNativeHostConnected]")};LoaderPortable.prototype.OnNativeHostDisconnected=function(){Logger_1.Logger.Log("[OnNativeHostDisconnected]")};LoaderPortable.prototype.OnNativeHostMessage=function(message){var _this=this;var requestId=message.RequestId;var requestData=message.RequestData;var codeVersion=requestData===null||requestData===void 0?void 0:requestData.codeVersion;if((requestData===null||requestData===void 0?void 0:requestData.functionCall)===NativeHostFunctionCall.LoadScripts){this.LoadScripts(requestData,this.GetNativeHostResponseCb(requestId))}else if((requestData===null||requestData===void 0?void 0:requestData.functionCall)===NativeHostFunctionCall.AddCustomLoader){CustomLoaderService_1.CustomLoaderService.AddCustomLoader(requestData,this.m_nativeHost,this.m_packageManager,this.GetNativeHostResponseCb(requestId))}else if(this.m_packageManager.IsCodeVersionAvailable(codeVersion)){this.m_packageManager.ProcessRequest(codeVersion,requestData,function(responseData){_this.SendNativeHostResponse(requestId,ExtensionResponseCode.Success,responseData)})}else{this.SendNativeHostResponse(requestId,ExtensionResponseCode.Error_NeedsScripts,{})}};LoaderPortable.prototype.GetNativeHostResponseCb=function(requestId){var _this=this;return function(){_this.SendNativeHostResponse(requestId,ExtensionResponseCode.Success,{})}};LoaderPortable.prototype.SendNativeHostResponse=function(requestId,responseCode,responseData){var response={RequestId:requestId,ResponseCode:responseCode,ResponseData:responseData};this.m_nativeHost.SendMsgToNativeHost(response)};LoaderPortable.prototype.LoadScripts=function(codeData,onCompletedCb){var codeVersion=codeData.codeVersion;Logger_1.Logger.Log("[LoadScripts] newVersion: "+codeVersion);var nativeHostToBackground={CallFunction:function(functionName,inputParams,returnFunc){returnFunc({})}};var codeMap={version:codeVersion,content:codeData.ContentScripts,background:codeData.BackgroundScripts};for(var scriptName in codeData.InjectedScripts){codeMap[scriptName]=codeData.InjectedScripts[scriptName]}this.m_packageManager.LoadDriverPackage(codeMap,nativeHostToBackground,onCompletedCb)};return LoaderPortable}());exports.LoaderPortable=LoaderPortable}),"./Source/Background/LoaderWin32.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LoaderWin32=void 0;var NativeHostConnector_1=__webpack_require__("./Source/Background/NativeHostConnector.ts");var BrowserTools_1=__webpack_require__("./Source/Utility/BrowserTools.ts");var ExtensionErrorService_1=__webpack_require__("./Source/ErrorPopup/ExtensionErrorService.ts");var Logger_1=__webpack_require__("./Source/Utility/Logger.ts");var ReturnCallbackMap_1=__webpack_require__("./Source/Utility/ReturnCallbackMap.ts");var CustomLoaderService_1=__webpack_require__("./Source/Background/CustomLoaderService.ts");var NativeHostFunctionCall;(function(NativeHostFunctionCall){NativeHostFunctionCall["OnProductVersionChanged"]="OnProductVersionChanged";NativeHostFunctionCall["AddCustomLoader"]="AddCustomLoader";NativeHostFunctionCall["_ValidatePermissions"]="_ValidatePermissions"})(NativeHostFunctionCall||(NativeHostFunctionCall={}));;var LoaderWin32=(function(){function LoaderWin32(packageManager,extensionError){this.m_callbackMap=new ReturnCallbackMap_1.ReturnCallbackMap;this.m_packageManager=packageManager;this.m_extensionErrorService=extensionError;var nativeAppName=BrowserTools_1.BrowserTools.IsChromeBrowser()?"com.uipath.chromenativemsg_v2":"com.uipath.chromenativemsg";this.m_nativeHost=new NativeHostConnector_1.NativeHostConnector(nativeAppName,this);this.RegisterWindowListeners()}LoaderWin32.prototype.OnNativeHostConnected=function(){var _this=this;Logger_1.Logger.Log("[OnNativeHostConnected]");this.RegisterAllWindowIds(function(){Logger_1.Logger.Log("[OnNativeHostConnected] Received reply to RegisterAllWindowIds");if(_this.m_extensionErrorService.GetError()===ExtensionErrorService_1.ExtensionErrorType.NativeHostDisconnected){_this.m_extensionErrorService.ClearExtensionError()}})};LoaderWin32.prototype.OnNativeHostDisconnected=function(){Logger_1.Logger.Log("[OnNativeHostDisconnected]");this.m_extensionErrorService.SetExtensionError(ExtensionErrorService_1.ExtensionErrorType.NativeHostDisconnected)};LoaderWin32.prototype.OnNativeHostMessage=function(message){var _this=this;if(message.functionCall){var driverRequest_1=message;if(driverRequest_1.functionCall===NativeHostFunctionCall.OnProductVersionChanged){this.OnProductVersionChanged(driverRequest_1)}else if(driverRequest_1.functionCall===NativeHostFunctionCall.AddCustomLoader){this.UnregisterWindowListeners();CustomLoaderService_1.CustomLoaderService.AddCustomLoader(message,this.m_nativeHost,this.m_packageManager,this.GetNativeHostResponseCb(driverRequest_1))}else if(driverRequest_1.functionCall===NativeHostFunctionCall._ValidatePermissions){this._ValidatePermissions()}else{this.m_packageManager.ProcessRequest(driverRequest_1.codeVersion,message,function(responseData){_this.SendNativeHostResponse(driverRequest_1,responseData)})}}else if(message.returnId){this.m_callbackMap.HandleReturnCallback(message.returnId,message)}else if(message.multipleProfilesError){this.OnMultipleProfilesError()}};LoaderWin32.prototype.OnProductVersionChanged=function(message){var _this=this;var newVersion=message.codeVersion;Logger_1.Logger.Log("[OnProductVersionChanged] begin newVersion: "+newVersion);this.ChangeImplementation(function(){Logger_1.Logger.Log("[OnProductVersionChanged] finished newVersion: "+newVersion);_this.SendNativeHostResponse(message)})};LoaderWin32.prototype.GetNativeHostResponseCb=function(driverRequest){var _this=this;return function(){_this.SendNativeHostResponse(driverRequest)}};LoaderWin32.prototype.SendNativeHostResponse=function(message,responseData){if(responseData===void 0){responseData={}}if(message.requestId!==undefined){var response=responseData;response.returnId=message.requestId;response.codeVersion=message.codeVersion;this.m_nativeHost.SendMsgToNativeHost(response)}};LoaderWin32.prototype.OnMultipleProfilesError=function(){Logger_1.Logger.Log("[OnMultipleProfilesError]");this.m_extensionErrorService.SetExtensionError(ExtensionErrorService_1.ExtensionErrorType.MultipleProfilesError)};LoaderWin32.prototype.ChangeImplementation=function(onCompletedCb){var _this=this;Logger_1.Logger.Log("[ChangeImplementation]");this.CallNativeHostFunction("LoadScripts",{},function(codeData){var nativeHostToBackground={CallFunction:function(functionName,inputParams,returnFunc){_this.CallNativeHostFunction(functionName,inputParams,returnFunc)}};_this.m_packageManager.LoadDriverPackage(codeData,nativeHostToBackground,onCompletedCb)})};LoaderWin32.prototype.RegisterAllWindowIds=function(onCompletedAllCb){var _this=this;Logger_1.Logger.Log("[RegisterAllWindowIds]");chrome.windows.getAll({populate:false},function(allWindows){Logger_1.Logger.Log("[RegisterAllWindowIds] allWindows.length: "+allWindows.length);var numNormalWindows=0;var lastNormalWindowId=0;for(var _i=0,allWindows_1=allWindows;_i<allWindows_1.length;_i++){var crtWindow=allWindows_1[_i];if(crtWindow.type==="normal"||crtWindow.type==="popup"){if(++numNormalWindows===2){break}lastNormalWindowId=crtWindow.id}}if(numNormalWindows===1){_this.RegisterWindowId(lastNormalWindowId,onCompletedAllCb)}else if(numNormalWindows>1){Logger_1.Logger.Error("UiPath::OnPageLoad: too many opened browser windows on extension init. Windows count: "+allWindows.length+". Please restart the browser and try again.");_this.m_extensionErrorService.SetExtensionError(ExtensionErrorService_1.ExtensionErrorType.MultipleWindowsError)}})};LoaderWin32.prototype.RegisterWindowListeners=function(){var _this=this;this.m_onWindowCreated=function(wnd){_this.RegisterWindowId(wnd.id)};this.m_onWindowRemoved=function(windowId){_this.UnregisterWindowId(windowId)};chrome.windows.onCreated.addListener(this.m_onWindowCreated);chrome.windows.onRemoved.addListener(this.m_onWindowRemoved)};LoaderWin32.prototype.UnregisterWindowListeners=function(){chrome.windows.onCreated.removeListener(this.m_onWindowCreated);chrome.windows.onRemoved.removeListener(this.m_onWindowRemoved)};LoaderWin32.prototype.RegisterWindowId=function(windowId,responseCb){Logger_1.Logger.Log("[RegisterWindowId] windowId: "+windowId);this.CallNativeHostFunction("RegisterNewlyCreatedWindowId",{windowId:windowId},responseCb)};LoaderWin32.prototype.UnregisterWindowId=function(windowId){Logger_1.Logger.Log("[UnregisterWindowId] windowId: "+windowId);this.CallNativeHostFunction("UnregisterWindowId",{windowId:windowId})};LoaderWin32.prototype.CallNativeHostFunction=function(functionName,inputParams,returnFunc){if(returnFunc!==undefined){inputParams.requestId=this.m_callbackMap.RegisterReturnCallback(returnFunc)}inputParams.functionCall=functionName;this.m_nativeHost.SendMsgToNativeHost(inputParams)};LoaderWin32.prototype._ValidatePermissions=function(){if(chrome.cookies&&chrome.cookies.getAllCookieStores){chrome.cookies.getAllCookieStores(function(cookieStores){if(!cookieStores){return}for(var i=0;i<cookieStores.length;++i){Logger_1.Logger.Log("Cookie Store Id: "+cookieStores[i].id)}})}if(chrome.webNavigation&&chrome.webNavigation.getAllFrames){chrome.tabs.query({active:true},function(tabs){if(!tabs||tabs.length===0){return}var activeTab=tabs[0];chrome.webNavigation.getAllFrames({tabId:activeTab.id},function(detailsArray){if(!detailsArray||detailsArray.length===0){return}var activeFrameDetails=detailsArray[0];Logger_1.Logger.Log("Active Tab Frame URL: "+activeFrameDetails.url)})})}if(chrome.debugger&&chrome.debugger.getTargets){chrome.debugger.getTargets(function(targets){if(!targets){return}for(var i=0;i<targets.length;++i){Logger_1.Logger.Log("Debug Target Id: "+targets[i].id)}})}};return LoaderWin32}());exports.LoaderWin32=LoaderWin32}),"./Source/Background/NativeHostConnector.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NativeHostConnector=void 0;var Logger_1=__webpack_require__("./Source/Utility/Logger.ts");var NativeHostConnector=(function(){function NativeHostConnector(nativeHostKey,client){var _this=this;this.m_nativeMsgPort=null;this.m_hasReceivedAnyMessageFromNativeHost=false;this.m_nativeHostKey=nativeHostKey;this.m_client=client;this.m_onNativeHostMessage=function(message,port){_this.HandleNativeHostMessage(message)};this.m_onNativeHostDisconnected=function(port){_this.HandleNativeHostDisconnect(port)};setTimeout(function(){_this.StartNativeHost()},1)}NativeHostConnector.prototype.SendMsgToNativeHost=function(message){try{if(this.m_nativeMsgPort){this.m_nativeMsgPort.postMessage(message)}else{Logger_1.Logger.Error("[SendMsgToNativeHost]"+" nativeHostKey: "+this.m_nativeHostKey+", Failed to send message because m_nativeMsgPort is not yet initialized.")}}catch(err){Logger_1.Logger.Error("[SendMsgToNativeHost] postMessage has thrown: "+err.toString())}};NativeHostConnector.prototype.SetClient=function(client){this.m_client=client};NativeHostConnector.prototype.DetachNativeHostPort=function(){if(!this.m_nativeMsgPort){return null}var tempPort=this.m_nativeMsgPort;this.m_nativeMsgPort.onMessage.removeListener(this.m_onNativeHostMessage);this.m_nativeMsgPort.onDisconnect.removeListener(this.m_onNativeHostDisconnected);this.m_nativeMsgPort=null;return tempPort};NativeHostConnector.prototype.StartNativeHost=function(){Logger_1.Logger.Log("[StartNativeHost] nativeHostKey: "+this.m_nativeHostKey);try{var nativeMsgPort=chrome.runtime.connectNative(this.m_nativeHostKey);if(nativeMsgPort){Logger_1.Logger.Log("[ConnectNativeHost] Created native messaging port with key: "+this.m_nativeHostKey);this.SetNativeHostPort(nativeMsgPort)}else{Logger_1.Logger.Error("[StartNativeHost] Failed to connect to: "+this.m_nativeHostKey)}}catch(err){Logger_1.Logger.Error("[StartNativeHost] runtime.connectNative has thrown: "+err.toString())}};NativeHostConnector.prototype.SetNativeHostPort=function(port){this.m_nativeMsgPort=port;if(!this.m_nativeMsgPort){return}this.m_nativeMsgPort.onMessage.addListener(this.m_onNativeHostMessage);this.m_nativeMsgPort.onDisconnect.addListener(this.m_onNativeHostDisconnected);this.OnNativeHostConnected()};NativeHostConnector.prototype.TryReconnectNativeHost=function(){var _this=this;Logger_1.Logger.Log("[TryReconnectNativeHost] "+this.m_nativeHostKey);setTimeout(function(){_this.StartNativeHost()},10000)};NativeHostConnector.prototype.OnNativeHostConnected=function(){var _a;Logger_1.Logger.Log("[OnNativeHostConnected]");(_a=this.m_client)===null||_a===void 0?void 0:_a.OnNativeHostConnected()};NativeHostConnector.prototype.HandleNativeHostMessage=function(message){var _a;this.m_hasReceivedAnyMessageFromNativeHost=true;(_a=this.m_client)===null||_a===void 0?void 0:_a.OnNativeHostMessage(message)};NativeHostConnector.prototype.HandleNativeHostDisconnect=function(port){var _a;if(chrome.runtime.lastError){Logger_1.Logger.Error("[HandleNativeHostDisconnect]"+" nativeHostKey: "+this.m_nativeHostKey+", lastError: "+chrome.runtime.lastError.message)}else{Logger_1.Logger.Log("[HandleNativeHostDisconnect] no error; nativeHostKey: "+this.m_nativeHostKey)}if(this.m_nativeMsgPort===port){this.m_nativeMsgPort=null;(_a=this.m_client)===null||_a===void 0?void 0:_a.OnNativeHostDisconnected();if(this.m_hasReceivedAnyMessageFromNativeHost){this.TryReconnectNativeHost()}}};return NativeHostConnector}());exports.NativeHostConnector=NativeHostConnector}),"./Source/Content/ContentLoader.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ContentLoader=exports.ContentLoaderRequestId=exports.ContentLoaderMessageId=void 0;var ContentEvalService_1=__webpack_require__("./Source/Eval/ContentEvalService.ts");var Logger_1=__webpack_require__("./Source/Utility/Logger.ts");var ContentLoaderMessageId;(function(ContentLoaderMessageId){ContentLoaderMessageId["LoadDriver"]="uipath_content_load_driver";ContentLoaderMessageId["UnloadDriver"]="uipath_content_finalize_driver";ContentLoaderMessageId["AddCustomLoader"]="uipath_content_add_custom_loader"})(ContentLoaderMessageId=exports.ContentLoaderMessageId||(exports.ContentLoaderMessageId={}));var ContentLoaderRequestId;(function(ContentLoaderRequestId){ContentLoaderRequestId["GetContentScripts"]="uipath_get_content_scripts"})(ContentLoaderRequestId=exports.ContentLoaderRequestId||(exports.ContentLoaderRequestId={}));var ContentLoader=(function(){function ContentLoader(){var _this=this;this.m_customLoaders={};chrome.runtime.onMessage.addListener(function(message,sender,sendResponse){if(message.type==ContentLoaderMessageId.LoadDriver){Logger_1.Logger.Log("OnBackgroundMessage: content scripts loaded from new codemap");var loadDriverRequest=message;_this.LoadDriverCode(loadDriverRequest.DriverCode,loadDriverRequest.Tab);sendResponse()}else if(message.type==ContentLoaderMessageId.UnloadDriver){var unloadDriverRequest=message;_this.FinalizeDriver(unloadDriverRequest.Tab);sendResponse()}else if(message.type==ContentLoaderMessageId.AddCustomLoader){var addLoaderRequest=message;_this.AddContentLoader(addLoaderRequest.ContentLoaderCode);sendResponse()}});chrome.runtime.sendMessage(ContentLoaderRequestId.GetContentScripts,function(response){_this.LoadDriverCode(response.DriverCode,response.Tab);for(var _i=0,_a=response.CustomLoaders;_i<_a.length;_i++){var contentLoader=_a[_i];_this.AddContentLoader(contentLoader)}})}ContentLoader.prototype.LoadDriverCode=function(driverCode,tab){if(!driverCode){return}Logger_1.Logger.Log("LoadDriverCode: message.version: "+driverCode.Version);try{ContentEvalService_1.ContentEvalService.EvalDriver(driverCode.ContentCode);if(chrome[ContentLoader.InitializeContentImpl]){chrome[ContentLoader.InitializeContentImpl](tab);chrome[ContentLoader.InitializeContentImpl]=null}else{Logger_1.Logger.Error("InitializeContentImpl undefined")}}catch(ex){Logger_1.Logger.Log("OnContentScriptLoadRequest failed to evaluate content script "+ex)}};ContentLoader.prototype.FinalizeDriver=function(tab){Logger_1.Logger.Log("FinalizeDriver");if(chrome[ContentLoader.FinalizeContentImpl]){chrome[ContentLoader.FinalizeContentImpl](tab);chrome[ContentLoader.FinalizeContentImpl]=null}else{Logger_1.Logger.Log("FinalizeDriver: chrome.FinalizeContentImpl is undefined")}};ContentLoader.prototype.AddContentLoader=function(contentLoader){this.m_customLoaders[contentLoader.Version]=ContentEvalService_1.ContentEvalService.EvalLoader(contentLoader.ContentCode)};ContentLoader.InitializeContentImpl="InitializeContentImpl";ContentLoader.FinalizeContentImpl="FinalizeContentImpl";return ContentLoader}());exports.ContentLoader=ContentLoader}),"./Source/ErrorPopup/ExtensionErrorService.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExtensionErrorService=exports.ExtensionErrorType=void 0;var Logger_1=__webpack_require__("./Source/Utility/Logger.ts");var ExtensionErrorType;(function(ExtensionErrorType){ExtensionErrorType["NoError"]="NoError";ExtensionErrorType["NativeHostDisconnected"]="NativeHostDisconnected";ExtensionErrorType["MultipleProfilesError"]="MultipleProfilesError";ExtensionErrorType["MultipleWindowsError"]="MultipleWindowsError"})(ExtensionErrorType=exports.ExtensionErrorType||(exports.ExtensionErrorType={}));;var ExtensionErrorService=(function(){function ExtensionErrorService(){this.m_error=null;this.m_errorMessage="";this.ClearExtensionError()}ExtensionErrorService.prototype.SetExtensionError=function(errorType){if(this.m_error===errorType){return}if(!chrome.browserAction){Logger_1.Logger.Error("[SetExtensionError] failed to retrieve BrowserActionAPI");return}Logger_1.Logger.Log("[SetExtensionError] errType: "+errorType);this.m_error=errorType;if(this.m_error===ExtensionErrorType.NoError){this.m_errorMessage="";chrome.browserAction.setBadgeText({text:""});chrome.browserAction.setPopup({popup:""});return}this.m_errorMessage=this.GetBrowserErrorLocalizedText(this.m_error);var badgeText=chrome.i18n.getMessage("badgeTextError");chrome.browserAction.setBadgeText({text:badgeText});chrome.browserAction.setPopup({popup:"popup.html"});chrome.browserAction.setBadgeBackgroundColor({color:[255,0,0,255]})};ExtensionErrorService.prototype.ClearExtensionError=function(){Logger_1.Logger.Log("[ClearExtensionError]");this.SetExtensionError(ExtensionErrorType.NoError)};ExtensionErrorService.prototype.GetError=function(){return this.m_error};ExtensionErrorService.prototype.GetPopupErrorMessage=function(){return this.m_errorMessage};ExtensionErrorService.prototype.GetBrowserErrorLocalizedText=function(errType){var popupText="";if(errType===ExtensionErrorType.NativeHostDisconnected){popupText=chrome.i18n.getMessage("nativeHostDisconnected")}else if(errType===ExtensionErrorType.MultipleWindowsError){popupText=chrome.i18n.getMessage("multipleWindowsError")}else if(errType===ExtensionErrorType.MultipleProfilesError){popupText=chrome.i18n.getMessage("multipleProfilesError")}return popupText};return ExtensionErrorService}());exports.ExtensionErrorService=ExtensionErrorService}),"./Source/Eval/BackgroundEvalService.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BackgroundEvalService=void 0;var EvalLoaderBackgroundCode_1=__webpack_require__("./Source/Eval/EvalLoaderBackgroundCode.js");var EvalDriverBackgroundCode_1=__webpack_require__("./Source/Eval/EvalDriverBackgroundCode.js");var BackgroundEvalService;(function(BackgroundEvalService){function EvalLoader(loaderCode,nativeHost,packageManager){return EvalLoaderBackgroundCode_1.EvalLoaderBackgroundCode(loaderCode,nativeHost,packageManager)}BackgroundEvalService.EvalLoader=EvalLoader;function EvalDriver(codeData,nativeHostToBackground){return EvalDriverBackgroundCode_1.EvalDriverBackgroundCode(codeData,nativeHostToBackground)}BackgroundEvalService.EvalDriver=EvalDriver})(BackgroundEvalService=exports.BackgroundEvalService||(exports.BackgroundEvalService={}))}),"./Source/Eval/ContentEvalService.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ContentEvalService=void 0;var EvalDriverContentCode_1=__webpack_require__("./Source/Eval/EvalDriverContentCode.js");var EvalLoaderContentCode_1=__webpack_require__("./Source/Eval/EvalLoaderContentCode.js");var ContentEvalService;(function(ContentEvalService){function EvalLoader(contentLoader){return EvalLoaderContentCode_1.EvalLoaderContentCode(contentLoader)}ContentEvalService.EvalLoader=EvalLoader;function EvalDriver(driverCode){EvalDriverContentCode_1.EvalDriverContentCode(driverCode)}ContentEvalService.EvalDriver=EvalDriver})(ContentEvalService=exports.ContentEvalService||(exports.ContentEvalService={}))}),"./Source/Eval/EvalDriverBackgroundCode.js":(function(module,exports){Object.defineProperty(exports,"__esModule",{value:true});exports.EvalDriverBackgroundCode=function(g_codeMap,g_nativeMsgComm){let IsChromeTabUrl=function(url){if(url&&url.indexOf("chrome://")===0){return true}return false};let getFileCodeObject=function(scriptName){return{code:g_codeMap[scriptName]}};eval(g_codeMap["background"]);delete g_codeMap["background"];let closureScopeExtender=function(){return this};let exportedData={_ClosureScopeExtender:closureScopeExtender,FunctionCallMap:g_functionCallMap,InitializeBackground:chrome["InitializeBackgroundImpl"],PostContentInitialize:chrome["PostContentInitializeImpl"],FinalizeBackground:chrome["FinalizeBackgroundImpl"]};return exportedData}}),"./Source/Eval/EvalDriverContentCode.js":(function(module,exports){Object.defineProperty(exports,"__esModule",{value:true});exports.EvalDriverContentCode=function(__driverCode){eval.call(window,__driverCode)}}),"./Source/Eval/EvalLoaderBackgroundCode.js":(function(module,exports){Object.defineProperty(exports,"__esModule",{value:true});exports.EvalLoaderBackgroundCode=function(__loaderCode,__nativeHost,__driverPackageManager){return eval(__loaderCode)}}),"./Source/Eval/EvalLoaderContentCode.js":(function(module,exports){Object.defineProperty(exports,"__esModule",{value:true});exports.EvalLoaderContentCode=function(__contentLoader){return eval(__contentLoader)}}),"./Source/Utility/BrowserTools.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BrowserTools=void 0;var Logger_1=__webpack_require__("./Source/Utility/Logger.ts");var BrowserTools=(function(){function BrowserTools(){}BrowserTools.SendMessageToAllTabs=function(getTabInputParamsCb,onCompletedAllCb){var _this=this;var queryParams={url:"<all_urls>"};chrome.tabs.query(queryParams,function(tabsList){var processTabCb=function(tab,onCompletedCb){if(_this.IsBrowserSettingsUrl(tab.url)){Logger_1.Logger.Log("SendMessageToAllTabs: skip chrome:// tab.id: "+tab.id);onCompletedCb()}else{Logger_1.Logger.Log("SendMessageToAllTabs: sending msg to tab.id: "+tab.id);var inputParams=getTabInputParamsCb(tab);chrome.tabs.sendMessage(tab.id,inputParams,function(respone){if(chrome.runtime.lastError){Logger_1.Logger.Warn("SendMessageToAllTabs: sendMessage failed to tab.id:"+tab.id+", tab.url: "+tab.url+", msg: "+chrome.runtime.lastError.message)}else{Logger_1.Logger.Log("SendMessageToAllTabs: message sent to tab.id: "+tab.id)}onCompletedCb()})}};_this.DoForAllAsync(tabsList,processTabCb,onCompletedAllCb)})};BrowserTools.DoForAllAsync=function(values,processValueCb,onCompletedAllCb){var OnAllCompleted=function(){if(onCompletedAllCb){onCompletedAllCb()}};var valuesCount=values?values.length:0;if(valuesCount==0){OnAllCompleted();return}var remainingValues=values.length;var OnValueProcessed=function(){--remainingValues;if(remainingValues<=0){OnAllCompleted()}};for(var _i=0,values_1=values;_i<values_1.length;_i++){var value=values_1[_i];try{processValueCb(value,function(){OnValueProcessed()})}catch(ex){Logger_1.Logger.Error(ex);OnValueProcessed()}}};BrowserTools.IsBrowserSettingsUrl=function(url){if(url&&((url.indexOf("chrome://")===0)||(url.indexOf("edge://")===0)||(url.indexOf("about:")===0))){return true}return false};BrowserTools.IsFirefoxBrowser=function(){var isFirefox=(window["mozInnerScreenX"]!==undefined);return isFirefox};BrowserTools.IsChromeBrowser=function(){var isChromeBrowser=true;if(this.IsFirefoxBrowser()){isChromeBrowser=false}return isChromeBrowser};return BrowserTools}());exports.BrowserTools=BrowserTools}),"./Source/Utility/Logger.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Logger=void 0;var Logger=(function(){function Logger(){}Logger.Log=function(msg){try{console.log(msg)}catch(e){}};Logger.Warn=function(msg){try{console.warn(new Error(msg))}catch(e){}};Logger.Error=function(msg){try{console.error(new Error(msg))}catch(e){}};return Logger}());exports.Logger=Logger}),"./Source/Utility/ReturnCallbackMap.ts":(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ReturnCallbackMap=void 0;var ReturnCallbackMap=(function(){function ReturnCallbackMap(){this.m_crtRequestId=0;this.m_returnMap={}}ReturnCallbackMap.prototype.RegisterReturnCallback=function(returnFunc){++this.m_crtRequestId;this.m_returnMap[this.m_crtRequestId]=returnFunc;return this.m_crtRequestId};ReturnCallbackMap.prototype.HandleReturnCallback=function(returnId,params){var returnFunc=this.m_returnMap[returnId];if(returnFunc!==undefined){returnFunc(params);delete this.m_returnMap[returnId]}};return ReturnCallbackMap}());exports.ReturnCallbackMap=ReturnCallbackMap})});